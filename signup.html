<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<title>羊毛剪注册</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css">
<!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css">
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js" type="text/javascript"></script>
<script src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.js" type="text/javascript"></script>
<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" type="text/javascript"></script>
<script src="rsa.min.js" type="text/javascript"></script>
</head>

<body style="padding:10px" onload="captcha()">
<br>
<br>
<input id="phoneNo" type="text" class="form-control input-lg has-success" style="height:80px; font-size:50px;" placeholder="手机号"><br>
<input id="password" type="password" class="form-control input-lg has-success" style="height:80px; font-size:50px;" placeholder="登录密码"><br>
<input id="rePassword" type="password" class="form-control input-lg has-success" style="height:80px; font-size:50px;" placeholder="重复登录密码"><br>
<div style="font-size:50px;"><font color='#EE1111'>请一定一定记住您的密码！以后如果修改为新密码是需要验证此密码的！！</font></div><br>
<button type="button"  class="form-control input-lg"  style="height:100px; font-size:50px; color:#FFF; background:#679deb;" onclick="signUp();">注册</button>
</body>
<script type="text/javascript">
var ccccptttcha;
function captcha(){
	$.ajax({
		url: 'http://207.148.102.32/wm/inout/datas?method=captcha&pol4=',
		type:'GET',
		cache:false,
		xhrFields: {
			withCredentials: true
		},
		crossDomain: true,
		success:function(data) {
			ccccptttcha = rsa(data);
		},
		error: function(XMLHttpRequest, textStatus, errorThrown){
			//alert("请求错误请重试")
		}
	});
}

function signUp(){
	if($("#phoneNo").val()==null || $("#phoneNo").val() == "" ||
		$("#password").val()==null || $("#password").val() == "" ||
		$("#rePassword").val()==null || $("#rePassword").val() == ""){
		alert("请填写注册信息");
		return;
	}
	if($("#password").val() != $("#rePassword").val()){
		alert("密码不一致");
		return;
	}
	if($("#phoneNo").val().length != 11 || $("#phoneNo").val()>"19999999999" || $("#phoneNo").val()<"13000000000"){
		alert("手机号错误");
		return;
	}
	//alert(ccccptttcha)
	$.ajax({
		url: "http://207.148.102.32/wm/inout/datas?method=signUp&pol4=" + encodeURI($("#phoneNo").val() + "\t"+ $("#password").val() + "\t"+"1"+"\t" + ccccptttcha),
		type:'GET',
		cache:false,
		xhrFields: {
			withCredentials: true
		},
		success:function(data) {
			if(data != null && data.indexOf("ERROR:")!= -1){
				//captcha();
				if(data.indexOf("验证码")!= -1){
					if(ccccptttcha != null && ccccptttcha != ''){
						alert("如果您用的苹果手机，请在“设置->Safari浏览器”选项下关闭“阻止跨网站”");
						return;
					}
					alert("提交失败请重试");
				}else{
					alert(data);
				}
				$("#signInButton").text('注册');
				captcha();
				return;
			}
			alert("注册成功");
			location = "index.html";
		},
		error: function(XMLHttpRequest, textStatus, errorThrown){
			captcha();
			alert("注册失败请重试")
			$("#signInButton").text('注册');
		}
	});
}

</script>
</html>