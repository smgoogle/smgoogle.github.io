<!DOCTYPE HTML>
<html>
<head>
<meta charset="UTF-8">
<title>羊毛剪注册</title>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css">
<!-- 可选的 Bootstrap 主题文件（一般不用引入） -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css">
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js" type="text/javascript"></script>
<script src="https://cdn.bootcss.com/jquery-cookie/1.4.1/jquery.cookie.js" type="text/javascript"></script>
<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js" type="text/javascript"></script>
<script src="rsa.min.js" type="text/javascript"></script>
</head>

<body style="padding:10px" onload="captcha();">
<br>
<br>
<input id="phoneNo" type="text" class="form-control input-lg has-success" style="height:80px; font-size:50px;" placeholder="手机号"><br>
<input id="password" type="password" class="form-control input-lg has-success" style="height:80px; font-size:50px;" placeholder="登录密码"><br>
<input id="rePassword" type="password" class="form-control input-lg has-success" style="height:80px; font-size:50px;" placeholder="重复登录密码"><br>
<input id="recBy" type="text" class="form-control input-lg has-success" style="height:80px; font-size:50px;" placeholder="推荐人"><br><br>
<button type="button"  class="form-control input-lg"  style="height:100px; font-size:50px;" onclick="signUp();">注册</button>
</body>
<script type="text/javascript">
var ccccptttcha;
function captcha(){
	$.ajax({
		url: 'http://localhost:8080/wm/inout/datas?method=captcha&pol4=',
		type:'GET',
		cache:false,
		xhrFields: {
			withCredentials: true
		},
		success:function(data) {
			ccccptttcha = rsa(data);
		},
		error: function(XMLHttpRequest, textStatus, errorThrown){
			alert("请求错误请重试")
		}
	});
}

function signUp(){
	if($("#phoneNo").val()==null || $("#phoneNo").val() == "" ||
		$("#password").val()==null || $("#password").val() == "" ||
		$("#rePassword").val()==null || $("#rePassword").val() == "" ||
		$("#recBy").val()==null || $("#recBy").val() == ""){
		alert("请填写注册信息");
		return;
	}
	if($("#password").val() != $("#rePassword").val()){
		alert("密码不一致");
		return;
	}
	if($("#phoneNo").val().length != 11 || $("#phoneNo").val()>"19999999999" || $("#phoneNo").val()<"13000000000"){
		alert("手机号错误");
		return;
	}
	
	$.ajax({
		url: "http://localhost:8080/wm/inout/datas?method=signUp&pol4=" + encodeURI($("#phoneNo").val() + "\t"+ $("#password").val() + "\t" + $("#recBy").val() + "\t" + ccccptttcha),
		type:'GET',
		cache:false,
		xhrFields: {
			withCredentials: true
		},
		success:function(data) {
			if(data != null && data.indexOf("ERROR:")!= -1){
				alert(data);
				return;
			}
			alert("注册成功");
			
			location = "index.html";
		},
		error: function(XMLHttpRequest, textStatus, errorThrown){
			alert("注册失败请重试")
		}
	});

}

</script>
</html>